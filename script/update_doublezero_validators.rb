# frozen_string_literal: true

require File.expand_path('../config/environment', __dir__)

DOUBLEZERO_IPS = [
  "185.167.205.3", "3.65.206.72", "5.255.78.21", "64.130.42.123", "64.130.32.133", "198.244.165.235", "45.76.33.214", "64.130.52.135", "142.91.158.164",
  "213.163.64.140", "209.38.103.172", "136.244.108.105", "194.126.172.174", "194.126.172.242", "89.42.231.199", "84.32.186.77", "64.130.55.254", "209.250.244.17",
  "74.118.136.173", "23.109.62.84", "194.126.172.170", "89.42.231.104", "147.75.84.157", "5.39.216.186", "202.8.8.21", "64.130.52.111", "64.130.52.205",
  "89.42.231.135", "84.32.186.112", "194.126.172.210", "84.32.186.110", "64.130.43.202", "149.255.37.170", "94.142.240.72", "178.239.19.42", "67.213.127.33",
  "84.32.186.78", "37.72.171.250", "185.52.237.102", "84.32.186.144", "88.216.197.11", "185.169.79.114", "67.213.113.133", "67.213.127.125", "64.130.52.201",
  "185.171.202.78", "62.197.45.241", "86.105.224.73", "89.42.231.167", "46.17.103.70", "5.199.172.136", "64.130.52.115", "64.130.55.13", "62.197.45.92",
  "212.7.200.110", "62.197.45.100", "38.244.189.66", "80.79.7.82", "67.213.127.17", "95.168.172.74", "62.197.45.108", "62.197.45.201", "80.251.153.166",
  "86.105.224.7", "31.128.59.202", "62.197.45.24", "62.197.45.139", "86.105.224.6", "194.126.172.186", "86.105.224.25", "64.130.42.88", "160.202.131.117",
  "195.12.227.249", "35.159.195.72", "189.1.171.173", "37.114.51.4", "64.130.32.77", "64.130.40.157", "67.213.113.103", "195.231.30.71", "86.111.48.190",
  "217.170.192.166", "45.139.132.156", "45.139.132.204", "45.139.132.171", "64.130.41.137", "64.130.40.185", "64.130.57.142", "45.77.142.108", "66.206.2.170",
  "185.92.120.151", "217.170.192.106", "91.209.71.13", "109.202.206.58", "45.158.38.50", "102.211.135.167", "45.158.38.30", "64.130.57.216", "217.170.206.42",
  "103.167.235.224", "136.244.86.123", "212.95.38.67", "64.130.32.173", "91.189.180.214", "82.197.162.50", "46.229.232.132", "45.139.132.37", "209.250.232.171",
  "64.130.32.60", "46.229.232.134", "64.130.40.217", "64.130.32.184", "83.143.84.202", "64.130.50.133", "94.158.242.131", "45.77.64.138", "46.166.162.139",
  "185.189.45.80", "37.61.220.2", "83.143.84.170", "134.119.192.242", "134.119.217.186", "178.162.238.198", "91.189.177.162", "64.130.32.206", "91.189.182.206",
  "185.101.32.250", "85.195.104.157", "102.211.135.164", "46.229.232.67", "102.211.135.162", "45.152.160.150", "5.39.251.201", "5.39.251.202", "5.39.251.203",
  "5.39.251.204", "5.39.251.205", "149.50.108.223", "147.28.171.13", "149.50.116.145", "45.139.132.107", "188.214.130.71", "65.20.100.233", "45.139.132.64",
  "93.115.25.190", "67.213.121.169", "188.214.130.97", "88.216.197.27", "89.111.15.150", "70.34.211.174", "31.172.68.190", "57.129.87.228", "45.139.132.87",
  "45.139.132.84", "8.52.192.204", "3.71.46.3", "185.221.164.109", "189.1.171.175", "189.1.171.177", "185.26.10.239", "67.213.113.97", "185.26.10.193",
  "93.100.241.247", "185.189.45.221", "147.28.165.79", "80.77.161.196", "94.158.242.130", "93.191.10.71", "185.171.202.77", "45.139.132.116", "45.135.201.224",
  "45.134.108.121", "159.148.20.196", "95.214.55.25", "185.26.10.211", "185.26.10.229", "45.139.132.97", "67.213.113.101", "45.134.108.188", "212.83.42.92",
  "45.134.108.184", "45.135.201.209", "188.214.130.101", "45.139.132.215", "159.148.20.198", "67.213.121.167", "45.135.201.200", "88.216.197.112", "212.83.42.33",
  "95.67.53.214", "67.213.121.175", "85.195.100.119", "57.128.64.53", "212.83.43.115", "149.50.116.14", "185.177.74.54", "45.152.160.116", "45.152.160.142",
  "81.16.237.134", "67.213.113.99", "212.83.43.62", "149.50.110.18", "185.26.10.233", "193.34.212.64", "45.139.132.38", "31.128.59.209", "45.139.132.23",
  "45.139.135.173", "109.94.96.59", "189.1.171.213", "95.179.209.177", "212.83.43.180", "45.139.132.188", "45.139.134.141", "45.139.135.43", "212.83.43.14",
  "212.83.43.208", "45.134.108.155", "45.139.132.88", "212.83.43.186", "212.83.42.39", "82.197.162.51", "212.83.42.35", "45.139.134.188", "212.83.43.168",
  "5.199.172.167", "147.28.171.51", "45.32.145.112", "45.139.135.197", "70.34.200.136", "45.134.108.254", "149.50.101.248", "212.83.42.66", "212.83.42.86",
  "94.158.242.132", "212.83.42.87", "185.191.116.170", "107.155.114.146", "5.187.35.10", "5.187.35.6", "45.139.132.52", "185.191.117.158", "45.139.132.226",
  "45.139.132.98", "45.139.132.105", "45.139.132.12", "45.139.134.38", "162.19.103.238", "89.42.231.137", "45.152.160.240", "45.134.108.88", "5.187.35.9",
  "183.81.169.123", "93.115.25.175", "185.191.118.12", "144.168.36.130", "104.237.53.202", "149.28.255.82", "69.67.149.97", "64.130.58.6", "192.69.209.194",
  "38.97.60.51", "54.215.102.227", "38.129.137.238", "23.92.79.26", "65.19.161.132", "72.46.85.217", "140.82.20.6", "104.237.51.122", "38.46.223.227",
  "103.88.234.129", "107.182.162.210", "45.76.239.188", "69.67.148.121", "15.204.108.105", "46.21.152.10", "108.171.217.186", "38.46.222.221", "38.92.24.98",
  "107.155.92.114", "216.238.67.40", "104.238.221.184", "141.98.218.84", "103.88.234.123", "142.4.55.162", "137.131.53.208", "50.115.46.202", "38.58.177.50",
  "8.52.160.4", "173.231.11.118", "108.171.203.18", "38.58.178.114", "38.46.223.238", "162.244.35.60", "137.220.32.24", "173.231.13.42", "104.238.220.71",
  "104.237.63.42", "216.18.214.178", "88.211.249.212", "103.50.32.128", "37.122.252.22", "65.20.105.212", "72.46.84.221", "193.221.135.102", "109.94.97.111",
  "64.130.63.76", "18.132.203.9", "109.94.97.181", "109.94.97.183", "109.94.97.13", "103.50.32.193", "77.81.119.214", "185.26.11.167", "185.26.11.195",
  "185.26.11.139", "72.46.84.217", "77.81.119.154", "139.84.228.251", "91.237.141.224", "198.244.253.205", "158.41.67.133", "94.46.194.194", "67.209.52.228",
  "82.163.195.20", "45.76.138.170", "139.84.238.57", "91.237.141.80", "195.140.213.74", "185.26.11.149", "95.179.230.90", "91.237.141.128", "109.94.97.193",
  "109.94.97.191", "185.26.11.145", "185.26.11.159", "72.46.84.115", "109.61.94.25", "45.76.138.26", "5.151.82.133", "5.151.82.130", "5.151.82.214", "5.151.82.178",
  "185.26.11.171", "207.121.26.12", "185.26.9.17", "69.67.151.19", "88.216.198.169", "208.91.110.197", "149.28.34.6", "177.54.159.47", "103.106.59.199", "67.213.120.9",
  "172.19.1.33", "45.63.111.115", "66.165.246.46", "64.130.51.81", "173.231.41.194", "66.45.251.114", "64.130.37.3", "149.28.38.64", "67.213.120.195", "74.50.79.146",
  "208.91.110.214", "149.28.113.63", "177.54.155.191", "185.26.8.37", "69.10.46.70", "35.212.25.53", "64.20.53.122", "149.248.51.171", "173.201.36.4", "23.227.189.30",
  "185.8.106.250", "84.32.32.19", "104.243.33.35", "107.155.98.198", "207.246.84.247", "162.250.124.6", "154.16.171.107", "84.32.32.86", "66.45.234.98", "145.40.74.211",
  "67.213.112.35", "173.201.36.164", "208.91.110.44", "149.255.32.130", "64.176.7.65", "64.176.12.167", "91.191.213.18", "192.69.194.82", "148.113.187.37", "183.81.168.165",
  "204.16.241.216", "185.209.178.161", "64.130.34.187", "64.130.51.19", "205.209.109.70", "141.98.216.86", "84.32.70.67", "204.13.234.82", "64.130.51.44", "149.28.111.64",
  "95.173.206.238", "141.98.216.168", "216.238.102.89", "185.26.9.29", "69.67.150.181", "45.250.254.69", "91.242.214.245", "216.128.150.115", "69.67.148.111", "38.127.60.128",
  "173.214.163.54", "149.255.32.194", "149.248.53.46", "103.88.233.21", "64.176.11.113", "69.67.150.135", "208.91.110.41", "192.69.194.218", "45.250.254.137", "195.12.228.194",
  "185.32.162.192", "177.54.154.15", "15.235.228.93", "72.46.87.231", "67.213.122.45", "177.54.154.235", "67.213.122.59", "202.8.11.195", "13.214.217.82", "8.245.23.252",
  "8.245.26.220", "5.199.164.218", "72.46.87.247", "103.28.89.181", "45.77.241.154", "5.199.164.220", "177.54.154.239", "107.155.109.202", "67.213.122.69", "15.235.232.142",
  "177.54.154.11", "177.54.154.221", "177.54.154.223", "177.54.154.225", "72.46.87.59", "177.54.154.241", "208.91.107.71", "52.194.235.230", "202.8.9.28", "64.130.44.108",
  "8.244.152.28", "109.94.99.211", "64.130.49.67", "64.130.49.117", "109.94.99.139", "23.227.220.223", "64.130.44.20"
]

logger = Logger.new('log/update_doublezero_validators.log')
logger.info("Updating DoubleZero validators...")

doublezero_validators_ids = []

begin
  DOUBLEZERO_IPS.each do |ip_address|
    ValidatorIp.where(is_active: true, address: ip_address).find_each do |validator_ip|
      next unless validator_ip.validator_id.present?

      doublezero_validators_ids << validator_ip.validator_id
    end
  end

  Validator.where.not(id: doublezero_validators_ids).update_all(is_dz: false)
  Validator.where(id: doublezero_validators_ids).update_all(is_dz: true)

  logger.info("DoubleZero validators updated successfully: #{doublezero_validators_ids}")
rescue StandardError => e
  logger.error("Failed to update DoubleZero validators: #{e}")
  Appsignal.send_error(e)
end
